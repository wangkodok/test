<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gsap full page animation</title>
    <link rel="stylesheet" href="./reset.css">
    <style>
        @font-face {
            font-family: "Freesentation";
            src: url("./font/Freesentation_VF.woff2") format("woff2");
            font-weight: normal;
            font-style: normal;
        }

        html {
            overflow: hidden;
            font-family: "Freesentation";
            font-size: 10px;
        }

        section {
            display: flex;
            justify-content: center;
            align-items: center;
            height: auto;
        }

        h2 {
            /* font-size: 6.25rem; */
            font-size: 10.417vw;
        }

        footer {
            padding: 6.25rem;
            font-size: 3rem;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <header></header>
    <main>
        <section id="visual">
            <h2 class="title">section 1</h2>
        </section>

        <section id="slider">
            <h2 class="title">section 2</h2>
        </section>

        <section id="contents">
            <h2 class="title">section 3</h2>
        </section>
    </main>
    <footer>footer</footer>

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
    <script>
        gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        const sections = document.querySelectorAll("section");
        const footer = document.querySelector("footer");
        const totalSections = sections.length + 1;
        let currentSection = 0;
        let isAnimating = false;
        let touchStartY = 0;
        let lastTouchY = 0; // ğŸ”¥ ì´ì „ í„°ì¹˜ ìœ„ì¹˜ ì €ì¥
        let touchStartTime = 0;
        let isTouching = false;

        // ğŸŒŸ í˜„ì¬ ë¸Œë¼ìš°ì € ë†’ì´(px)ë¡œ ì„¹ì…˜ í¬ê¸° ì„¤ì •
        function setSectionHeight() {
            const viewportHeight = window.innerHeight;
            sections.forEach(section => {
                section.style.height = `${viewportHeight}px`;
            });
        }

        // ğŸŒŸ íŠ¹ì • ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
        function scrollToSection(index) {
            if (isAnimating) return;
            isAnimating = true;

            gsap.to(window, {
                duration: 0.8,
                scrollTo: {
                    y: index === totalSections - 1 ? footer : sections[index],
                    autoKill: false
                },
                ease: "power2.out",
                onComplete: () => {
                    isAnimating = false;
                }
            });
        }

        // ğŸŒŸ PC ë§ˆìš°ìŠ¤ íœ  ì´ë²¤íŠ¸
        function wheelEvent(e) {
            if (isAnimating) return;

            let direction = e.deltaY > 0 ? 1 : -1;
            let nextSection = currentSection + direction;

            if (nextSection >= 0 && nextSection < totalSections) {
                currentSection = nextSection;
                scrollToSection(currentSection);
            }
        }

        // ğŸŒŸ ëª¨ë°”ì¼ í„°ì¹˜ ì´ë²¤íŠ¸ ê°œì„ 
        function touchStart(e) {
            touchStartY = e.touches[0].clientY;
            lastTouchY = touchStartY; // ğŸ”¥ ì‹œì‘í•  ë•Œ ì´ì „ í„°ì¹˜ ìœ„ì¹˜ ì´ˆê¸°í™”
            touchStartTime = Date.now();
            isTouching = true;
        }

        function touchMove(e) {
            if (!isTouching || isAnimating) return;

            let touchCurrentY = e.touches[0].clientY;
            let delta = lastTouchY - touchCurrentY; // ğŸ”¥ ë§ˆì§€ë§‰ ìœ„ì¹˜ì™€ í˜„ì¬ ìœ„ì¹˜ ì°¨ì´ ê³„ì‚°
            let threshold = 30;

            if (Math.abs(delta) > threshold) {
                let nextSection = currentSection + (delta > 0 ? 1 : -1);

                if (nextSection >= 0 && nextSection < totalSections) {
                    currentSection = nextSection;
                    lastTouchY = touchCurrentY; // ğŸ”¥ ë§ˆì§€ë§‰ ìœ„ì¹˜ ê°±ì‹ 
                    requestAnimationFrame(() => scrollToSection(currentSection));
                }
            }
        }

        function touchEnd() {
            isTouching = false; // ğŸ”¥ í„°ì¹˜ ì¢…ë£Œ ì‹œ ìƒíƒœ ì´ˆê¸°í™”
        }

        // ğŸŒŸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        window.addEventListener("load", setSectionHeight);
        window.addEventListener("resize", setSectionHeight);
        window.addEventListener("wheel", wheelEvent);
        window.addEventListener("touchstart", touchStart);
        window.addEventListener("touchmove", touchMove);
        window.addEventListener("touchend", touchEnd);
    </script>
    <script>
        // gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        // const sections = document.querySelectorAll("section");
        // const footer = document.querySelector("footer");
        // const totalSections = sections.length + 1;
        // let currentSection = 0;
        // let isAnimating = false;
        // let touchStartY = 0;
        // let touchEndY = 0;

        // // ğŸŒŸ í˜„ì¬ ë¸Œë¼ìš°ì € ë†’ì´(px)ë¡œ ì„¹ì…˜ í¬ê¸° ì„¤ì •
        // function setSectionHeight() {
        //     const viewportHeight = window.innerHeight;
        //     sections.forEach(section => {
        //         section.style.height = `${viewportHeight}px`;
        //     });
        // }

        // // ğŸŒŸ íŠ¹ì • ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
        // function scrollToSection(index) {
        //     if (isAnimating) return;
        //     isAnimating = true;

        //     gsap.to(window, {
        //         duration: 0.8,
        //         scrollTo: {
        //             y: index === totalSections - 1 ? footer : sections[index],
        //             autoKill: false
        //         },
        //         ease: "power2.out",
        //         onComplete: () => {
        //             isAnimating = false;
        //         }
        //     });
        // }

        // // ğŸŒŸ PC ë§ˆìš°ìŠ¤ íœ  ì´ë²¤íŠ¸
        // function wheelEvent(e) {
        //     if (isAnimating) return;

        //     let direction = e.deltaY > 0 ? 1 : -1;
        //     let nextSection = currentSection + direction;

        //     if (nextSection >= 0 && nextSection < totalSections) {
        //         currentSection = nextSection;
        //         scrollToSection(currentSection);
        //     }
        // }

        // // ğŸŒŸ ëª¨ë°”ì¼ í„°ì¹˜ ì´ë²¤íŠ¸
        // function touchStart(e) {
        //     touchStartY = e.touches[0].clientY;
        // }

        // function touchMove(e) {
        //     touchEndY = e.touches[0].clientY; // ì´ë™ ì¤‘ ìœ„ì¹˜ ì €ì¥
        // }

        // function touchEnd() {
        //     let delta = touchStartY - touchEndY; // í„°ì¹˜ ì´ë™ ê±°ë¦¬ ê³„ì‚°
        //     let threshold = 10; // ìµœì†Œ ì´ë™ ê±°ë¦¬ (50px)

        //     if (Math.abs(delta) > threshold) { // ğŸ”¥ 50px ì´ìƒ ì´ë™í–ˆì„ ë•Œë§Œ ì‹¤í–‰
        //         let nextSection = currentSection + (delta > 0 ? 1 : -1);

        //         if (nextSection >= 0 && nextSection < totalSections) {
        //             currentSection = nextSection;
        //             scrollToSection(currentSection);
        //         }
        //     }
        // }

        // // ğŸŒŸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        // window.addEventListener("load", setSectionHeight);
        // window.addEventListener("resize", setSectionHeight);
        // window.addEventListener("wheel", wheelEvent);
        // window.addEventListener("touchstart", touchStart);
        // window.addEventListener("touchmove", touchMove);
        // window.addEventListener("touchend", touchEnd);


        // gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        // const sections = document.querySelectorAll("section");
        // const footer = document.querySelector("footer");
        // const totalSections = sections.length + 1;
        // let currentSection = 0;
        // let isAnimating = false;
        // let touchStartY = 0;
        // let lastTouchY = 0;
        // let touchDirection = 0; // í„°ì¹˜ ë°©í–¥ (1: ì•„ë˜ë¡œ, -1: ìœ„ë¡œ)

        // // ğŸŒŸ í˜„ì¬ ë¸Œë¼ìš°ì € ë†’ì´(px)ë¡œ ì„¹ì…˜ í¬ê¸° ì„¤ì •
        // function setSectionHeight() {
        //     const viewportHeight = window.innerHeight;
        //     sections.forEach(section => {
        //         section.style.height = `${viewportHeight}px`;
        //     });
        // }

        // // ğŸŒŸ íŠ¹ì • ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
        // function scrollToSection(index) {
        //     if (isAnimating) return;
        //     isAnimating = true;

        //     gsap.to(window, {
        //         duration: 1,
        //         scrollTo: {
        //             y: index === totalSections - 1 ? footer : sections[index],
        //             autoKill: false
        //         },
        //         ease: "power2.out",
        //         onComplete: () => {
        //             isAnimating = false;
        //         }
        //     });
        // }

        // // ğŸŒŸ PC ë§ˆìš°ìŠ¤ íœ  ì´ë²¤íŠ¸
        // function wheelEvent(e) {
        //     if (isAnimating) return;

        //     let direction = e.deltaY > 0 ? 1 : -1;
        //     let nextSection = currentSection + direction;

        //     if (nextSection >= 0 && nextSection < totalSections) {
        //         currentSection = nextSection;
        //         scrollToSection(currentSection);
        //     }
        // }

        // // ğŸŒŸ ëª¨ë°”ì¼ í„°ì¹˜ ì´ë²¤íŠ¸
        // function touchStart(e) {
        //     touchStartY = e.touches[0].clientY;
        //     lastTouchY = touchStartY; // ì´ˆê¸°í™”
        //     touchDirection = 0; // ë°©í–¥ ì´ˆê¸°í™”
        // }

        // function touchMove(e) {
        //     let currentTouchY = e.touches[0].clientY;
        //     let delta = lastTouchY - currentTouchY; // í„°ì¹˜ ì´ë™ ê±°ë¦¬
        //     lastTouchY = currentTouchY;

        //     // í„°ì¹˜ ë°©í–¥ ê°ì§€
        //     if (Math.abs(delta) > 10) { // ì‘ì€ ì›€ì§ì„ ë¬´ì‹œ
        //         touchDirection = delta > 0 ? 1 : -1;
        //     }
        // }

        // function touchEnd() {
        //     if (touchDirection !== 0) { // ë°©í–¥ì´ ê°ì§€ëœ ê²½ìš°ì—ë§Œ ì´ë™
        //         let nextSection = currentSection + touchDirection;

        //         if (nextSection >= 0 && nextSection < totalSections) {
        //             currentSection = nextSection;
        //             scrollToSection(currentSection);
        //         }
        //     }
        // }

        // // ğŸŒŸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        // window.addEventListener("load", setSectionHeight);
        // window.addEventListener("resize", setSectionHeight);
        // window.addEventListener("wheel", wheelEvent);
        // window.addEventListener("touchstart", touchStart);
        // window.addEventListener("touchmove", touchMove);
        // window.addEventListener("touchend", touchEnd);


    </script>
    <!-- <script>
        gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        const sections = document.querySelectorAll("section");
        const footer = document.querySelector("footer");
        const totalSections = sections.length + 1;
        let currentSection = 0;
        let isAnimating = false;

        // í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ currentSection ì„¤ì •
        function updateCurrentSection() {
            let scrollY = window.scrollY;
            sections.forEach((section, index) => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                if (scrollY >= sectionTop && scrollY < sectionTop + sectionHeight) {
                    currentSection = index;
                };
            });

            // í‘¸í„°ì— ìˆëŠ” ê²½ìš° ë§ˆì§€ë§‰ ì„¹ì…˜ìœ¼ë¡œ ì„¤ì •
            if (scrollY + window.innerHeight >= document.body.scrollHeight) {
                currentSection = totalSections - 1;
            };
        };

        // ìƒˆë¡œê³ ì¹¨ ì‹œ ì´ˆê¸° ì„¹ì…˜ ì—…ë°ì´íŠ¸
        window.addEventListener("load", updateCurrentSection);

        function scrollToSection(index) {
            if (isAnimating) return;
            isAnimating = true;

            if (index === totalSections - 1) {
                gsap.to(window, {
                    duration: 1,
                    scrollTo: {
                        y: footer,
                        autoKill: false
                    },
                    ease: "power2.out",
                    onComplete: () => {
                        isAnimating = false;
                    },
                });
            } else {
                gsap.to(window, {
                    duration: 1,
                    scrollTo: {
                        y: sections[index],
                        autoKill: false
                    },
                    ease: "power2.out",
                    onComplete: () => {
                        isAnimating = false;
                    }
                });
            };
        };

        function wheelEvent(e) {
            if (isAnimating) return;

            if (e.deltaY > 0 && currentSection < totalSections - 1) {
                currentSection++;
                scrollToSection(currentSection);
            } else if (e.deltaY < 0 && currentSection > 0) {
                currentSection--;
                scrollToSection(currentSection);
            };
        };

        window.addEventListener("wheel", wheelEvent);

        function setSectionHeight() {
            const viewportHeight = window.innerHeight; // í˜„ì¬ ë¸Œë¼ìš°ì € ë†’ì´(px)
            sections.forEach(section => {
                section.style.height = `${viewportHeight}px`;
            });
        };

        // ì´ˆê¸° ì‹¤í–‰ ë° ìœˆë„ìš° í¬ê¸° ë³€ê²½ ì‹œ ì—…ë°ì´íŠ¸
        window.addEventListener("load", setSectionHeight);
        window.addEventListener("resize", setSectionHeight);
    </script> -->
</body>

</html>