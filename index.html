<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gsap full page animation</title>
    <link rel="stylesheet" href="./reset.css">
    <style>
        @font-face {
            font-family: "Freesentation";
            src: url("./font/Freesentation_VF.woff2") format("woff2");
            font-weight: normal;
            font-style: normal;
        }

        html {
            overflow: hidden;
            font-family: "Freesentation";
        }

        section {
            display: flex;
            justify-content: center;
            align-items: center;
            height: auto;
        }

        h2 {
            font-size: 6.25rem;
        }

        footer {
            padding: 6.25rem;
            font-size: 3rem;
            font-weight: 500;
        }
    </style>
</head>

<body>
    <header></header>
    <main>
        <section id="visual">
            <h2 class="title">section 1</h2>
        </section>

        <section id="slider">
            <h2 class="title">section 2</h2>
        </section>

        <section id="contents">
            <h2 class="title">section 3</h2>
        </section>
    </main>
    <footer>footer</footer>

    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
    <script>
        gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        const sections = document.querySelectorAll("section");
        const footer = document.querySelector("footer");
        const totalSections = sections.length + 1;
        let currentSection = 0;
        let isAnimating = false;
        let touchStartY = 0;
        let touchEndY = 0;
        let touchStartTime = 0;

        // üåü ÌòÑÏû¨ Î∏åÎùºÏö∞Ï†Ä ÎÜíÏù¥(px)Î°ú ÏÑπÏÖò ÌÅ¨Í∏∞ ÏÑ§Ï†ï
        function setSectionHeight() {
            const viewportHeight = window.innerHeight;
            sections.forEach(section => {
                section.style.height = `${viewportHeight}px`;
            });
        }

        // üåü ÌäπÏ†ï ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§ Ïù¥Îèô
        function scrollToSection(index) {
            if (isAnimating) return;
            isAnimating = true;

            gsap.to(window, {
                duration: 0.8,
                scrollTo: {
                    y: index === totalSections - 1 ? footer : sections[index],
                    autoKill: false
                },
                ease: "power2.out",
                onComplete: () => {
                    isAnimating = false;
                }
            });
        }

        // üåü PC ÎßàÏö∞Ïä§ Ìú† Ïù¥Î≤§Ìä∏
        function wheelEvent(e) {
            if (isAnimating) return;

            let direction = e.deltaY > 0 ? 1 : -1;
            let nextSection = currentSection + direction;

            if (nextSection >= 0 && nextSection < totalSections) {
                currentSection = nextSection;
                scrollToSection(currentSection);
            }
        }

        // üåü Î™®Î∞îÏùº ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏ Í∞úÏÑ†
        function touchStart(e) {
            touchStartY = e.touches[0].clientY;
            touchEndY = touchStartY;
            touchStartTime = Date.now();
        }

        function touchMove(e) {
            touchEndY = e.touches[0].clientY; // Ïù¥Îèô Ï§ë ÏúÑÏπò Ï†ÄÏû•
        }

        function touchEnd() {
            let delta = touchStartY - touchEndY; // ÌÑ∞Ïπò Ïù¥Îèô Í±∞Î¶¨ Í≥ÑÏÇ∞
            let elapsedTime = Date.now() - touchStartTime; // ÌÑ∞ÏπòÌïú ÏãúÍ∞Ñ Ï∞®Ïù¥
            let threshold = 30; // ÌÑ∞Ïπò Ïù¥Îèô ÏµúÏÜå Í±∞Î¶¨(px)
            let fastSwipeThreshold = 200; // Îπ†Î•¥Í≤å Ïä§ÏôÄÏù¥ÌîÑÌïú Í≤ΩÏö∞(ms)

            // üî• Ïù¥Îèô Í±∞Î¶¨Í∞Ä Ï∂©Î∂ÑÌûà ÌÅ¨Í±∞ÎÇò, Îπ†Î•¥Í≤å Ïä§ÏôÄÏù¥ÌîÑÌïú Í≤ΩÏö∞ Ïã§Ìñâ
            if (Math.abs(delta) > threshold || elapsedTime < fastSwipeThreshold) {
                let nextSection = currentSection + (delta > 0 ? 1 : -1);

                if (nextSection >= 0 && nextSection < totalSections) {
                    currentSection = nextSection;
                    requestAnimationFrame(() => scrollToSection(currentSection));
                }
            }
        }

        // üåü Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        window.addEventListener("load", setSectionHeight);
        window.addEventListener("resize", setSectionHeight);
        window.addEventListener("wheel", wheelEvent);
        window.addEventListener("touchstart", touchStart);
        window.addEventListener("touchmove", touchMove);
        window.addEventListener("touchend", touchEnd);

        // gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        // const sections = document.querySelectorAll("section");
        // const footer = document.querySelector("footer");
        // const totalSections = sections.length + 1;
        // let currentSection = 0;
        // let isAnimating = false;
        // let touchStartY = 0;
        // let touchEndY = 0;

        // // üåü ÌòÑÏû¨ Î∏åÎùºÏö∞Ï†Ä ÎÜíÏù¥(px)Î°ú ÏÑπÏÖò ÌÅ¨Í∏∞ ÏÑ§Ï†ï
        // function setSectionHeight() {
        //     const viewportHeight = window.innerHeight;
        //     sections.forEach(section => {
        //         section.style.height = `${viewportHeight}px`;
        //     });
        // }

        // // üåü ÌäπÏ†ï ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§ Ïù¥Îèô
        // function scrollToSection(index) {
        //     if (isAnimating) return;
        //     isAnimating = true;

        //     gsap.to(window, {
        //         duration: 0.8,
        //         scrollTo: {
        //             y: index === totalSections - 1 ? footer : sections[index],
        //             autoKill: false
        //         },
        //         ease: "power2.out",
        //         onComplete: () => {
        //             isAnimating = false;
        //         }
        //     });
        // }

        // // üåü PC ÎßàÏö∞Ïä§ Ìú† Ïù¥Î≤§Ìä∏
        // function wheelEvent(e) {
        //     if (isAnimating) return;

        //     let direction = e.deltaY > 0 ? 1 : -1;
        //     let nextSection = currentSection + direction;

        //     if (nextSection >= 0 && nextSection < totalSections) {
        //         currentSection = nextSection;
        //         scrollToSection(currentSection);
        //     }
        // }

        // // üåü Î™®Î∞îÏùº ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏
        // function touchStart(e) {
        //     touchStartY = e.touches[0].clientY;
        // }

        // function touchMove(e) {
        //     touchEndY = e.touches[0].clientY; // Ïù¥Îèô Ï§ë ÏúÑÏπò Ï†ÄÏû•
        // }

        // function touchEnd() {
        //     let delta = touchStartY - touchEndY; // ÌÑ∞Ïπò Ïù¥Îèô Í±∞Î¶¨ Í≥ÑÏÇ∞
        //     let threshold = 10; // ÏµúÏÜå Ïù¥Îèô Í±∞Î¶¨ (50px)

        //     if (Math.abs(delta) > threshold) { // üî• 50px Ïù¥ÏÉÅ Ïù¥ÎèôÌñàÏùÑ ÎïåÎßå Ïã§Ìñâ
        //         let nextSection = currentSection + (delta > 0 ? 1 : -1);

        //         if (nextSection >= 0 && nextSection < totalSections) {
        //             currentSection = nextSection;
        //             scrollToSection(currentSection);
        //         }
        //     }
        // }

        // // üåü Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        // window.addEventListener("load", setSectionHeight);
        // window.addEventListener("resize", setSectionHeight);
        // window.addEventListener("wheel", wheelEvent);
        // window.addEventListener("touchstart", touchStart);
        // window.addEventListener("touchmove", touchMove);
        // window.addEventListener("touchend", touchEnd);


        // gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        // const sections = document.querySelectorAll("section");
        // const footer = document.querySelector("footer");
        // const totalSections = sections.length + 1;
        // let currentSection = 0;
        // let isAnimating = false;
        // let touchStartY = 0;
        // let lastTouchY = 0;
        // let touchDirection = 0; // ÌÑ∞Ïπò Î∞©Ìñ• (1: ÏïÑÎûòÎ°ú, -1: ÏúÑÎ°ú)

        // // üåü ÌòÑÏû¨ Î∏åÎùºÏö∞Ï†Ä ÎÜíÏù¥(px)Î°ú ÏÑπÏÖò ÌÅ¨Í∏∞ ÏÑ§Ï†ï
        // function setSectionHeight() {
        //     const viewportHeight = window.innerHeight;
        //     sections.forEach(section => {
        //         section.style.height = `${viewportHeight}px`;
        //     });
        // }

        // // üåü ÌäπÏ†ï ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§ Ïù¥Îèô
        // function scrollToSection(index) {
        //     if (isAnimating) return;
        //     isAnimating = true;

        //     gsap.to(window, {
        //         duration: 1,
        //         scrollTo: {
        //             y: index === totalSections - 1 ? footer : sections[index],
        //             autoKill: false
        //         },
        //         ease: "power2.out",
        //         onComplete: () => {
        //             isAnimating = false;
        //         }
        //     });
        // }

        // // üåü PC ÎßàÏö∞Ïä§ Ìú† Ïù¥Î≤§Ìä∏
        // function wheelEvent(e) {
        //     if (isAnimating) return;

        //     let direction = e.deltaY > 0 ? 1 : -1;
        //     let nextSection = currentSection + direction;

        //     if (nextSection >= 0 && nextSection < totalSections) {
        //         currentSection = nextSection;
        //         scrollToSection(currentSection);
        //     }
        // }

        // // üåü Î™®Î∞îÏùº ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏
        // function touchStart(e) {
        //     touchStartY = e.touches[0].clientY;
        //     lastTouchY = touchStartY; // Ï¥àÍ∏∞Ìôî
        //     touchDirection = 0; // Î∞©Ìñ• Ï¥àÍ∏∞Ìôî
        // }

        // function touchMove(e) {
        //     let currentTouchY = e.touches[0].clientY;
        //     let delta = lastTouchY - currentTouchY; // ÌÑ∞Ïπò Ïù¥Îèô Í±∞Î¶¨
        //     lastTouchY = currentTouchY;

        //     // ÌÑ∞Ïπò Î∞©Ìñ• Í∞êÏßÄ
        //     if (Math.abs(delta) > 10) { // ÏûëÏùÄ ÏõÄÏßÅÏûÑ Î¨¥Ïãú
        //         touchDirection = delta > 0 ? 1 : -1;
        //     }
        // }

        // function touchEnd() {
        //     if (touchDirection !== 0) { // Î∞©Ìñ•Ïù¥ Í∞êÏßÄÎêú Í≤ΩÏö∞ÏóêÎßå Ïù¥Îèô
        //         let nextSection = currentSection + touchDirection;

        //         if (nextSection >= 0 && nextSection < totalSections) {
        //             currentSection = nextSection;
        //             scrollToSection(currentSection);
        //         }
        //     }
        // }

        // // üåü Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        // window.addEventListener("load", setSectionHeight);
        // window.addEventListener("resize", setSectionHeight);
        // window.addEventListener("wheel", wheelEvent);
        // window.addEventListener("touchstart", touchStart);
        // window.addEventListener("touchmove", touchMove);
        // window.addEventListener("touchend", touchEnd);


    </script>
    <!-- <script>
        gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

        const sections = document.querySelectorAll("section");
        const footer = document.querySelector("footer");
        const totalSections = sections.length + 1;
        let currentSection = 0;
        let isAnimating = false;

        // ÌòÑÏû¨ Ïä§ÌÅ¨Î°§ ÏúÑÏπòÎ•º Í∏∞Î∞òÏúºÎ°ú currentSection ÏÑ§Ï†ï
        function updateCurrentSection() {
            let scrollY = window.scrollY;
            sections.forEach((section, index) => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                if (scrollY >= sectionTop && scrollY < sectionTop + sectionHeight) {
                    currentSection = index;
                };
            });

            // Ìë∏ÌÑ∞Ïóê ÏûàÎäî Í≤ΩÏö∞ ÎßàÏßÄÎßâ ÏÑπÏÖòÏúºÎ°ú ÏÑ§Ï†ï
            if (scrollY + window.innerHeight >= document.body.scrollHeight) {
                currentSection = totalSections - 1;
            };
        };

        // ÏÉàÎ°úÍ≥†Ïπ® Ïãú Ï¥àÍ∏∞ ÏÑπÏÖò ÏóÖÎç∞Ïù¥Ìä∏
        window.addEventListener("load", updateCurrentSection);

        function scrollToSection(index) {
            if (isAnimating) return;
            isAnimating = true;

            if (index === totalSections - 1) {
                gsap.to(window, {
                    duration: 1,
                    scrollTo: {
                        y: footer,
                        autoKill: false
                    },
                    ease: "power2.out",
                    onComplete: () => {
                        isAnimating = false;
                    },
                });
            } else {
                gsap.to(window, {
                    duration: 1,
                    scrollTo: {
                        y: sections[index],
                        autoKill: false
                    },
                    ease: "power2.out",
                    onComplete: () => {
                        isAnimating = false;
                    }
                });
            };
        };

        function wheelEvent(e) {
            if (isAnimating) return;

            if (e.deltaY > 0 && currentSection < totalSections - 1) {
                currentSection++;
                scrollToSection(currentSection);
            } else if (e.deltaY < 0 && currentSection > 0) {
                currentSection--;
                scrollToSection(currentSection);
            };
        };

        window.addEventListener("wheel", wheelEvent);

        function setSectionHeight() {
            const viewportHeight = window.innerHeight; // ÌòÑÏû¨ Î∏åÎùºÏö∞Ï†Ä ÎÜíÏù¥(px)
            sections.forEach(section => {
                section.style.height = `${viewportHeight}px`;
            });
        };

        // Ï¥àÍ∏∞ Ïã§Ìñâ Î∞è ÏúàÎèÑÏö∞ ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω Ïãú ÏóÖÎç∞Ïù¥Ìä∏
        window.addEventListener("load", setSectionHeight);
        window.addEventListener("resize", setSectionHeight);
    </script> -->
</body>

</html>